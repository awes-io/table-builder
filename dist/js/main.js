/**
 * Bundle of AWES table-builder
 * Generated: 2019-05-27 14:07:19
 * Version: 1.2.0
 */

!function(){"use strict";const t=t=>t.trim();var e={scrollTo:"body",scrollDuration:200,mediaQueries:{mobile:"(max-width: 600px)",tablet:"(min-width: 601px) and (max-width: 900px)",desktop:"(min-width: 901px)"},sort:{param:"orderBy",ascTemplate:"%s",descTemplate:"%s_desc"}},s={props:{mediaQueries:{type:Object,default(){return this._config.mediaQueries}}},data:()=>({matchedMedia:[]}),methods:{_getMediaName(t){return Object.keys(this.mediaQueries).find(e=>this.mediaQueries[e]===t)},_checkMediaMatch(t){return t.split(",").some(t=>this.matchedMedia.includes(t.trim()))},onMatchMedia(t){let e=this._getMediaName(t.media),s=this.matchedMedia.indexOf(e);t.matches&&!~s&&this.matchedMedia.push(e),!t.matches&&~s&&this.matchedMedia.splice(s,1)}},beforeCreate(){this._config=Object.assign(e,_.pick(AWES._config.tableBuilder,Object.keys(e)))},beforeMount(){this._mq={};for(let t in this.mediaQueries)try{this._mq[t]=window.matchMedia(this.mediaQueries[t]),this._mq[t].matches&&this.matchedMedia.push(t),this._mq[t].addListener(this.onMatchMedia)}catch(t){console.log("Table builder: ",t)}},beforeDestroy(){if(this._mq)for(let t in this._mq)this._mq[t].removeListener(this.onMatchMedia)}},a={beforeCreate(){this._config=Object.assign(e,_.pick(AWES._config.tableBuilder,Object.keys(e)))}};function i(t){(function(t){let e=!1;const s=["A","BUTTON"],a=t=>s.includes(t.tagName);for(;!e&&"TR"!==t.tagName;)a(t)&&(e=!0),t=t.parentElement;return e})(t.target)||this.listeners.click.call(window,this.props)}function r(t){t.preventDefault(),t.stopPropagation(),this.listeners.setActive(this.props.index,!this.props.active)}var n={name:"tb-row",functional:!0,props:{data:{type:Object,required:!0},tableOptions:{type:Array,required:!0},index:{type:Number,required:!0},active:{type:Boolean,default:!1},url:String,matchedMedia:Array,showToggler:{type:Boolean,default:!1}},render(t,e){const s=e.props,a=s.tableOptions.map((e,a)=>t("td",{staticClass:[e.className],key:a},function(t,e){return e.scopedSlots?e.scopedSlots({data:t.data,index:t.index,active:t.active,matchedMedia:t.matchedMedia}):t.data[e.name]}(s,e)));return s.showToggler&&a.push(t("td",{key:"toggler",on:{click:r.bind(e)},attrs:{class:"int-table__control-tab"}},[t("a",{attrs:{class:"int-table__show",href:""}},[t("i",{attrs:{class:"icon icon-box-down"}})])])),t("tr",{staticClass:"int-table__block",class:{active:s.active,"is-link":s.url},key:s.index+"-row",on:s.url?{click:i.bind(e)}:void 0},a)}};function o(t,e,s,a,i,r,n,o,l,c){"function"==typeof n&&(l=o,o=n,n=!1);const d="function"==typeof s?s.options:s;let u;if(t&&t.render&&(d.render=t.render,d.staticRenderFns=t.staticRenderFns,d._compiled=!0,i&&(d.functional=!0)),a&&(d._scopeId=a),r?(u=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),e&&e.call(this,l(t)),t&&t._registeredComponents&&t._registeredComponents.add(r)},d._ssrRegister=u):e&&(u=n?function(){e.call(this,c(this.$root.$options.shadowRoot))}:function(t){e.call(this,o(t))}),u)if(d.functional){const t=d.render;d.render=function(e,s){return u.call(s),t(e,s)}}else{const t=d.beforeCreate;d.beforeCreate=t?[].concat(t,u):[u]}return s}const l=n;n.__file="tb-row.vue";var c=o({},void 0,l,void 0,void 0,void 0,void 0,void 0),d={name:"tb-sort-button",mixins:[a],props:{asc:{type:String,required:!0},desc:{type:String,required:!0}},computed:{currentOrder(){return this.$route.query.orderBy},orderParams(){return[this.asc,this.desc,null]},isAsc(){return this.currentOrder===this.asc},isDesc(){return this.currentOrder===this.desc},isActive(){return this.isAsc||this.isDesc}},methods:{sort(){let t={};t[this._config.sort.param]=this._getNext(),this.$router.$setParam(t,!1)},_getNext(){let t=this.orderParams.indexOf(this.currentOrder)+1;return t=t>=this.orderParams.length?0:t,this.orderParams[t]}}};const u=d;d.__file="tb-sort-button.vue";var h={name:"table-builder",mixins:[s,a],components:{tbRow:c,tbSortButton:o({render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("button",{staticClass:"tb-sort-button",class:{"is-active":t.isActive,"is-asc":t.isAsc,"is-desc":t.isDesc},on:{click:t.sort}},[t._t("default"),t._v(" "),s("svg",{attrs:{width:"16",height:"16",viewBox:"0 0 20 20"}},[s("path",{directives:[{name:"show",rawName:"v-show",value:t.isAsc,expression:"isAsc"}],attrs:{d:"M17 13H3l7-8z"}}),t._v(" "),s("path",{directives:[{name:"show",rawName:"v-show",value:t.isDesc,expression:"isDesc"}],attrs:{d:"M3 7h14l-7 8z"}}),t._v(" "),s("path",{directives:[{name:"show",rawName:"v-show",value:!t.isActive,expression:"! isActive"}],attrs:{d:"M17 9H3l7-8z M3 11h14l-7 8z"}})])],2)},staticRenderFns:[]},void 0,u,void 0,!1,void 0,void 0,void 0)},props:{default:[Array,Object],listClass:{type:String,default:"int-table__list"},listRowClass:{type:String,default:"int-table__list-row"},rowUrl:String,rowClick:{type:Function,default(t){t&&t.url&&(window.location.href=AWES.utils.urlFromTemplate(t.url,t.data))}}},data:()=>({activeItem:null}),computed:{tableData(){return Array.isArray(this.default)?this.default:[this.default]},columns(){return this.$slots.default&&this.$slots.default.filter(t=>t.componentOptions&&"tb-column"===t.componentOptions.tag)},hasColumns(){return this.columns&&!!this.columns.length},tableOptions(){return this.columns&&this.columns.map(t=>Object.assign({},t.componentOptions.propsData,{className:t.data.staticClass,scopedSlots:t.data.scopedSlots&&t.data.scopedSlots.default?t.data.scopedSlots.default:null}))},shownOptions(){return this.tableOptions&&this.tableOptions.filter(t=>{if(!t.media||t.media&&this._checkMediaMatch(t.media))return!0})},hiddenOptions(){return this.tableOptions&&this.tableOptions.filter(t=>{if(t.media&&!this._checkMediaMatch(t.media))return!0}).map(t=>t.name)},hiddenColumnData(){return!(!this.hiddenOptions||!this.hiddenOptions.length)&&this.tableData.map(t=>{if(!t)return;let e={};return Object.keys(t).filter(t=>this.hiddenOptions.includes(t)).forEach(s=>{e[s]=t[s]}),e})},columnsHead(){return this.shownOptions.map(t=>{return{label:(t=>t.charAt(0).toUpperCase()+t.slice(1))(void 0!==t.label?t.label:t.name),sort:"string"==typeof t.sort&&this._getSortParams(t.name,t.sort)}})}},watch:{hiddenColumnData(t){!1===t&&(this.activeItem=null)}},methods:{setActiveItem(t,e){this.activeItem=e?t:null},_getSortParams(e,s){let a=this.$get(this._config,"sort.ascTemplate").replace("%s",e),i=this.$get(this._config,"sort.descTemplate").replace("%s",e);if(""!==s){let[e,r]=s.split("|").map(t);a=e||a,i=r||i}return{asc:a,desc:i}}}};const p=h;h.__file="table-builder.vue";var m=o({render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"int-table"},[t._t("header"),t._v(" "),t.tableData&&!t.hasColumns?s("div",{class:t.listClass},t._l(t.tableData,function(e,a){return s("div",{key:a,class:t.listRowClass},[t._t("list",["object"==typeof e?t._l(e,function(e,a){return s("div",{key:a,staticClass:"int-table__list-cell"},[s("span",{staticClass:"int-table__list-name"},[t._v(t._s(a)+" : ")]),t._v(" "),s("span",{staticClass:"int-table__list-value"},[t._v(t._s(e))])])}):[t._v("\n                    "+t._s(e)+"\n                ")]],{tableData:t.tableData,data:e,index:a})],2)}),0):t._e(),t._v(" "),t.tableData&&t.hasColumns?s("table",{staticClass:"int-table__table"},[s("thead",[s("tr",[t._l(t.columnsHead,function(e,a){var i=e.label,r=e.sort;return s("th",{key:a},[r?s("tb-sort-button",t._b({},"tb-sort-button",r,!1),[t._v("\n                        "+t._s(i)+"\n                    ")]):[t._v(t._s(i))]],2)}),t._v(" "),t.hiddenOptions&&t.hiddenOptions.length?s("th"):t._e()],2)]),t._v(" "),s("tbody",[t._l(t.tableData,function(e,a){return[s("tb-row",{key:a+"-row",ref:"tbRows",refInFor:!0,attrs:{tableOptions:t.shownOptions,data:e,index:a,active:t.activeItem===a,url:t.rowUrl,matchedMedia:t.matchedMedia,showToggler:!!t.hiddenColumnData},on:{setActive:t.setActiveItem,click:t.rowClick}}),t._v(" "),t.hiddenColumnData?s("tr",{directives:[{name:"show",rawName:"v-show",value:t.activeItem===a,expression:"activeItem === i"}],key:a+"-hidden-row",staticClass:"int-table__hidden"},[s("td",{attrs:{colspan:t.shownOptions.length+1}},[t._t("hidden",[s("ul",t._l(t.hiddenColumnData[a],function(e,a){return s("li",{key:a+"-hidden"},[t._v("\n                                    "+t._s(e)+"\n                                ")])}),0)],{data:e,hiddenData:t.hiddenColumnData[a],matchedMedia:t.matchedMedia,index:a})],2)]):t._e()]})],2)]):t._e(),t._v(" "),t._t("footer")],2)},staticRenderFns:[]},void 0,p,void 0,!1,void 0,void 0,void 0),v={name:"tb-column",props:{name:String,label:String,media:String,sort:String}};const g=v;v.__file="tb-column.vue";var f=o({},void 0,g,void 0,void 0,void 0,void 0,void 0),b={name:"paginate-builder",mixins:[a],props:{meta:Object,scrollTo:{type:[String,Boolean],default(){return this._config.scrollTo}}},data:()=>({serverData:{}}),computed:{currentPage(){return parseInt(this.$get(this.$route.query,"page"))||1},paginate(){if(!this.meta)return null;if(this.meta.last_page<2)return!1;if(this.meta.last_page<=7)return Array(this.meta.last_page).fill().map((t,e)=>e+1);let t=[1],e=this.meta.current_page-2,s=this.meta.current_page+2;e<=1?(e=2,s=6):s>=this.meta.last_page&&(s=this.meta.last_page-1,e=this.meta.last_page-6+1);for(let a=e;a<=s;a++)a!==e&&a!==s||2===a||a===this.meta.last_page-1?t.push(a):t.push(!1);return t.push(this.meta.last_page),t},scrollElement(){return this.scrollTo&&this._isMounted&&document.querySelector(this.scrollTo)}},methods:{setPage(t){t>0&&this.meta&&t<=this.meta.last_page&&this.$router.$setParam({page:t.toString()})},getStringified(t){return this.$route.path+"?"+AWES.utils.stringifyQuery(Object.assign({},this.$route.query,{page:t}))+this.$route.hash}},created(){!1===this.default?this.updateData(this.$route):this.serverData=this.default}};const w=b;b.__file="paginate-builder.vue";var y=o({render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.meta?s("div",{staticClass:"pager"},[s("span",{staticClass:"pager__caption"},[t._v("Record "+t._s(t.meta.from)+"-"+t._s(t.meta.to)+" of "+t._s(t.meta.total))]),t._v(" "),t.paginate?s("div",{staticClass:"pager__middle"},[s("div",{staticClass:"pager__links"},[s("a",{staticClass:"pager__arr-left awes-spa-ignore",attrs:{href:t.getStringified(t.currentPage-1)},on:{click:function(e){e.stopPropagation(),e.preventDefault(),t.setPage(t.currentPage-1)}}},[s("i",{staticClass:"icon icon-arrow-left"})]),t._v(" "),s("div",{staticClass:"btn-group"},[t._l(t.paginate,function(e,a){return[e?s("a",{key:a,staticClass:"btn has-wave awes-spa-ignore",class:{active:e===t.currentPage},attrs:{href:t.getStringified(e)},on:{click:function(s){s.stopPropagation(),s.preventDefault(),t.setPage(e)}}},[t._v("\n                        "+t._s(e)+"\n                        "),s("span",{staticClass:"wave"})]):s("span",{key:a,staticClass:"btn-group__separator"},[t._v("...")])]})],2),t._v(" "),s("a",{staticClass:"pager__arr-right awes-spa-ignore",attrs:{href:t.getStringified(t.currentPage+1)},on:{click:function(e){e.stopPropagation(),e.preventDefault(),t.setPage(t.currentPage+1)}}},[s("i",{staticClass:"icon icon-arrow-right"})])])]):t._e(),t._v(" "),s("div",{staticClass:"pager__shows"},[s("context-menu",{attrs:{top:""}},[s("template",{slot:"toggler"},[s("span",{staticClass:"pager__shows-link"},[t._v(t._s(t.meta.per_page))])]),t._v(" "),s("cm-query",{attrs:{param:{limit:"",page:""}}},[t._v("10")]),t._v(" "),s("cm-query",{attrs:{param:{limit:"50",page:""}}},[t._v("50")]),t._v(" "),s("cm-query",{attrs:{param:{limit:"100",page:""}}},[t._v("100")])],2)],1)]):t._e()},staticRenderFns:[]},void 0,w,void 0,!1,void 0,void 0,void 0);var C={installed:!1,install:function(t){this.installed||(this.installed=!0,t.component("table-builder",m),t.component("tb-column",f),t.component("paginate-builder",y))}},O={TABLE_NO_DATA:"No data, check the connection quality",TABLE_LOADING:"Loading..."};const k={name:"table-builder",version:"1.2.0",modules:{"vue-smoothscroll":{src:"https://unpkg.com/vue-smoothscroll@0.2.0/dist/vue-smoothscroll.js",deps:["vue"],cb(){Vue.use(VueSmoothScroll)}},lodash:{src:"https://unpkg.com/lodash@4.17.11/lodash.min.js",deps:["vue"]}},install(){Vue.use(C),AWES.lang=O}};window&&"AWES"in window?AWES.use(k):(window.__awes_plugins_stack__=window.__awes_plugins_stack__||[],window.__awes_plugins_stack__.push(k))}();
